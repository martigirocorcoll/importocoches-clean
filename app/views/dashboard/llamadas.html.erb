<div class="dashboard-header" style="margin-bottom: 30px;">
  <h1 style="color: #2c3e50; font-size: 28px; margin-bottom: 10px;">
    <i class="fa-solid fa-phone"></i> Llamadas API
  </h1>
  <p style="color: #7f8c8d;">Registro de llamadas a la API de mobile.de</p>
</div>

<div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px;">
  <div class="row">
    <div class="col-md-3">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title text-primary"><%= @total_count %></h5>
          <p class="card-text">Total llamadas (mes actual)</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title text-warning"><%= @bot_count %></h5>
          <p class="card-text">Llamadas de bots</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title text-danger"><%= @suspicious_ips_count %></h5>
          <p class="card-text">IPs sospechosas</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center">
        <div class="card-body">
          <h5 class="card-title text-success"><%= @legitimate_count %></h5>
          <p class="card-text">Llamadas legítimas</p>
        </div>
      </div>
    </div>
  </div>
</div>

<div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
  <div class="table-responsive">
    <table class="table table-striped table-sm">
      <thead>
        <tr>
          <th>ID</th>
          <th>Fecha</th>
          <th>IP</th>
          <th>User Agent</th>
          <th>Método</th>
          <th>Endpoint</th>
        </tr>
      </thead>
      <tbody>
        <% @llamadas_display.each do |llamada| %>
          <tr>
            <td><%= llamada.id %></td>
            <td><%= llamada.created_at.strftime("%d/%m %H:%M") %></td>
            <td><%= llamada.ip_address %></td>
            <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;">
              <%= llamada.user_agent&.truncate(50) %>
            </td>
            <td>
              <span class="badge badge-<%= llamada.request_method == 'GET' ? 'primary' : 'warning' %>">
                <%= llamada.request_method %>
              </span>
            </td>
            <td><%= llamada.endpoint %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  
  <div class="mt-3 d-flex justify-content-between">
    <small class="text-muted">
      Mostrando <%= @llamadas_display.count %> de <%= @total_count %> llamadas
    </small>
    
    <div class="pagination-info">
      <small class="text-muted">
        Página <%= @current_page %> de <%= @total_pages %>
      </small>
    </div>
  </div>
</div>